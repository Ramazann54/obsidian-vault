## 1. Общие понятия

**Семафоры, мьютексы и фьютексы** — это примитивы синхронизации, используемые для:

- обеспечения взаимного исключения;
    
- координации выполнения процессов и потоков;
    
- предотвращения состояний состязания при доступе к общим ресурсам.
    

Они различаются по назначению, семантике и способу реализации.

---

## 2. Семафоры

### 2.1. Понятие семафора

**Семафор** — это целочисленная переменная, доступ к которой осуществляется только с помощью атомарных операций:

- `P()` (wait, down) — уменьшает значение семафора;
    
- `V()` (signal, up) — увеличивает значение семафора.
    

Если при выполнении `P()` значение семафора становится отрицательным, процесс блокируется.

---

### 2.2. Виды семафоров

#### 2.2.1. Бинарный семафор

- принимает значения 0 или 1;
    
- используется для взаимного исключения.
    

---

#### 2.2.2. Счётный семафор

- может принимать произвольные неотрицательные значения;
    
- используется для управления доступом к ограниченному числу ресурсов.
    

---

### 2.3. Особенности семафоров

**Преимущества:**

- универсальность;
    
- возможность решать широкий круг задач синхронизации.
    

**Недостатки:**

- сложность корректного использования;
    
- возможность взаимных блокировок;
    
- отсутствие привязки к владельцу ресурса.
    

---

## 3. Мьютексы

### 3.1. Понятие мьютекса

**Мьютекс (mutex, mutual exclusion)** — это примитив синхронизации, предназначенный исключительно для обеспечения взаимного исключения.

Ключевая особенность:

> мьютекс **имеет владельца** — поток, который его захватил.

---

### 3.2. Основные операции

- `lock()` — захват мьютекса;
    
- `unlock()` — освобождение мьютекса.
    

Если поток пытается освободить мьютекс, которым не владеет, это считается ошибкой.

---

### 3.3. Особенности мьютексов

**Преимущества:**

- простота и наглядность;
    
- меньшая вероятность логических ошибок;
    
- поддержка механизмов защиты от инверсии приоритета.
    

**Недостатки:**

- применимы только для взаимного исключения;
    
- не подходят для счётных ресурсов.
    

---

## 4. Фьютексы

### 4.1. Понятие фьютекса

**Фьютекс (futex, fast userspace mutex)** — это гибридный механизм синхронизации, сочетающий:

- быстрое ожидание в пользовательском пространстве;
    
- блокировку через ядро ОС только при необходимости.
    

Фьютекс используется преимущественно в Linux.

---

### 4.2. Принцип работы фьютекса

1. Поток проверяет значение в памяти **в пользовательском режиме**.
    
2. Если ресурс свободен — захват происходит без обращения к ядру.
    
3. Если ресурс занят — поток переходит в ядро и блокируется.
    
4. При освобождении ресурса ядро пробуждает ожидающие потоки.
    

---

### 4.3. Преимущества фьютексов

- высокая производительность;
    
- минимальное количество системных вызовов;
    
- эффективная работа при низкой конкуренции.
    

---

### 4.4. Недостатки фьютексов

- сложность реализации;
    
- зависимость от поддержки ОС;
    
- используются как основа для более высокоуровневых примитивов.
    

---

## 5. Сравнение семафоров, мьютексов и фьютексов

|Характеристика|Семафор|Мьютекс|Фьютекс|
|---|---|---|---|
|Назначение|синхронизация, ресурсы|взаимное исключение|оптимизация мьютексов|
|Владение|нет|есть|есть (логически)|
|Счётчик|да|нет|нет|
|Работа без ядра|нет|иногда|да|
|Основное применение|классические задачи|защита КО|высокопроизводительные ОС|

---

## 6. Связь с предыдущими темами

- семафоры и мьютексы используются для защиты **критических областей**;
    
- фьютексы реализуют **эффективную синхронизацию** без постоянного обращения к ядру;
    
- все три примитива предотвращают **состояния состязания**.
    

---

## 7. Короткая экзаменационная формулировка

> Семафоры, мьютексы и фьютексы являются примитивами синхронизации, предназначенными для управления доступом к общим ресурсам.  
> Семафоры представляют собой счётные или бинарные переменные и применяются для широкого круга задач синхронизации.  
> Мьютексы обеспечивают взаимное исключение и имеют владельца.  
> Фьютексы являются оптимизированным механизмом, сочетающим пользовательскую и ядерную синхронизацию, что позволяет снизить накладные расходы.

---
